{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Jhon\\\\Desktop\\\\proyectos-IS1\\\\bookflix\\\\front-end\\\\src\\\\components\\\\Suscriptores\\\\IniciarSesion.js\";\nimport React, { Component } from 'react';\nimport axios from 'axios';\nimport { BrowserRouter as Router, Route, Redirect } from 'react-router-dom';\nconst login = 'http://localhost:4000/api/suscriptores/login';\n\nclass App extends Component {\n  constructor() {\n    super();\n\n    this.getToken = res => {\n      //pido la data de la respuesta  \n      const {\n        data\n      } = res;\n      const {\n        user,\n        token\n      } = data; //guardo el token en session storage\n\n      sessionStorage.setItem('token', token);\n      sessionStorage.setItem('user', JSON.stringify({\n        user\n      }));\n      this.setState({\n        token: sessionStorage.getItem('token'),\n        user: data.user\n      });\n      console.log(\"user:\");\n      console.log(JSON.parse(sessionStorage.getItem(\"user\")));\n      console.log(\"token:\");\n      console.log(JSON.parse(sessionStorage.getItem('token')));\n    };\n\n    this.onInputChange = event => {\n      this.setState({\n        [event.target.name]: event.target.value\n      });\n    };\n\n    this.state = {\n      email: '',\n      password: '',\n      token: '',\n      user: null\n    };\n    this.iniciarSesion = this.iniciarSesion.bind(this);\n    this.onInputChange = this.onInputChange.bind(this);\n  }\n\n  async iniciarSesion(event) {\n    console.log(this.state);\n    event.preventDefault();\n    await axios.post(login, {\n      email: this.state.email,\n      password: this.state.password\n    }).then(res => this.getToken(res)).catch(err => console.log(err));\n  }\n\n  //faltan los setState, y no funca el POST\n  render() {\n    return console.log('token'), console.log(this.state.token), //verifico si existe el token\n    !this.state.token && !this.state.user ? /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-md-6 offset-md-3 form-login\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"card card-body bg-dark  text-light \",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"form\", {\n      onSubmit: this.iniciarSesion,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"form-group\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      className: \"text-light\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 21\n      }\n    }, \"Email\"), /*#__PURE__*/React.createElement(\"input\", {\n      className: \"form-control\",\n      id: \"email\",\n      name: \"email\",\n      onChange: this.onInputChange,\n      value: this.state.email,\n      placeholder: \"Ingrese un email\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 21\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"form-group\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      className: \"text-light\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 21\n      }\n    }, \"Contrase\\xF1a\"), /*#__PURE__*/React.createElement(\"input\", {\n      className: \"form-control\",\n      id: \"password\",\n      name: \"password\",\n      onChange: this.onInputChange,\n      value: this.state.password,\n      placeholder: \"Ingrese la contrase\\xF1a\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 21\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"form-group\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      type: \"submit\",\n      className: \"btn btn-danger btn-lg btn-block\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 25\n      }\n    }, \"LOGIN\")))))) : /*#__PURE__*/React.createElement(Redirect, {\n      from: \"/login\",\n      to: \"/home\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 9\n      }\n    });\n  }\n\n}\n\nexport default App;","map":{"version":3,"sources":["C:/Users/Jhon/Desktop/proyectos-IS1/bookflix/front-end/src/components/Suscriptores/IniciarSesion.js"],"names":["React","Component","axios","BrowserRouter","Router","Route","Redirect","login","App","constructor","getToken","res","data","user","token","sessionStorage","setItem","JSON","stringify","setState","getItem","console","log","parse","onInputChange","event","target","name","value","state","email","password","iniciarSesion","bind","preventDefault","post","then","catch","err","render"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\r\nimport axios from 'axios';\r\nimport { BrowserRouter as Router, Route , Redirect } from 'react-router-dom';\r\n\r\nconst login = 'http://localhost:4000/api/suscriptores/login';\r\n\r\n\r\n\r\n   \r\n\r\nclass App extends Component {\r\n    \r\n    constructor (){\r\n        super();\r\n        this.state = {\r\n            email: '',\r\n            password:'',\r\n            token:'',\r\n            user:null,\r\n      };\r\n        this.iniciarSesion = this.iniciarSesion.bind(this);\r\n        this.onInputChange = this.onInputChange.bind(this);\r\n\r\n    }\r\n\r\n    getToken=(res)=>{\r\n        //pido la data de la respuesta  \r\n        const { data } = res;\r\n        const { user, token}= data;        \r\n        //guardo el token en session storage\r\n    \r\n        sessionStorage.setItem('token',token);\r\n        sessionStorage.setItem('user',JSON.stringify({user}));\r\n        this.setState(\r\n            {\r\n                token:sessionStorage.getItem('token'),\r\n                user: data.user,\r\n            }\r\n        );\r\n        console.log(\"user:\");    \r\n        console.log(JSON.parse(sessionStorage.getItem(\"user\")));   \r\n        console.log(\"token:\");    \r\n        console.log(JSON.parse(sessionStorage.getItem('token')));\r\n            \r\n    }\r\n\r\n    async iniciarSesion(event){\r\n\r\n        console.log(this.state);\r\n        event.preventDefault();   \r\n        await axios.post(login,{\r\n            email: this.state.email,\r\n            password: this.state.password,\r\n        })\r\n                .then(res =>this.getToken(res))\r\n                .catch(err => console.log(err));\r\n        \r\n    }\r\n\r\n    \r\n    onInputChange = (event) => {\r\n        this.setState({\r\n            [event.target.name]: event.target.value\r\n        })\r\n    };\r\n    \r\n\r\n//faltan los setState, y no funca el POST\r\n    render(){\r\n        return (\r\n        console.log('token'),\r\n        console.log(this.state.token),    \r\n        //verifico si existe el token\r\n        !this.state.token && !this.state.user?\r\n        <div>\r\n\r\n        <div className=\"col-md-6 offset-md-3 form-login\">\r\n            <div className=\"card card-body bg-dark  text-light \" >\r\n\r\n                <form onSubmit={this.iniciarSesion}>\r\n                    <div className=\"form-group\">\r\n                    <label className=\"text-light\">Email\r\n                    </label>\r\n                    <input \r\n                        className=\"form-control\" \r\n                        id=\"email\" \r\n                        name =\"email\"\r\n                        onChange={this.onInputChange}\r\n                        value={this.state.email}\r\n\r\n                        placeholder=\"Ingrese un email\">\r\n                    </input>    \r\n                    </div>\r\n\r\n                    <div className=\"form-group\">\r\n                    <label className=\"text-light\">Contraseña\r\n                    </label>\r\n                    <input \r\n                        className=\"form-control\" \r\n                        id=\"password\" \r\n                        name =\"password\"\r\n                        onChange={this.onInputChange}\r\n                        value={this.state.password}\r\n                        placeholder=\"Ingrese la contraseña\">\r\n                    </input>    \r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                        <button  type=\"submit\" className=\"btn btn-danger btn-lg btn-block\">\r\n                            LOGIN\r\n                        </button>\r\n                    </div>\r\n                </form>\r\n            </div>   \r\n            \r\n        </div>\r\n        </div>\r\n          \r\n        :\r\n        <Redirect\r\n        from=\"/login\"\r\n        to=\"/home\" />\r\n        )\r\n    }\r\n}\r\n\r\n\r\nexport default App; "]},"metadata":{},"sourceType":"module"}